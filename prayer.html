<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ora√ß√£o Di√°ria - Equipes de Nossa Senhora</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/assets/prayer/style.css">
</head>
<body>
    <div class="liturgical-bar" id="liturgicalBar"></div>

    <header class="app-header" id="appHeader">
        <div class="header-icons">
            <button id="commonPrayersBtn" class="icon-btn" title="Ora√ß√µes Comuns">üìú</button>
            <button id="themeToggle" class="icon-btn" title="Alternar Tema">üåì</button>
            <button id="notificationBtn" class="icon-btn notification-btn inactive" title="Notifica√ß√µes">üîï</button>
        </div>
        
        <div id="notificationMenu" class="notification-menu">
            <h3>Configura√ß√µes</h3>
            <div class="menu-row">
                <label>Lembretes</label>
                <label class="switch">
                    <input type="checkbox" id="notifToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="time-input-container">
                <label class="time-input-label">Hor√°rio do lembrete</label>
                <input type="time" id="notifTime">
            </div>
            <button id="saveNotif" class="btn btn-primary" style="padding: 12px; font-size: 0.85em; margin-bottom: 12px;">Salvar</button>
            <button id="shareAppBtn" class="btn btn-secondary" style="padding: 12px; font-size: 0.85em;">Compartilhar App</button>
        </div>

        <span class="cross">‚úù</span>
        <h1>ENS DIA A DIA</h1>
        <p id="headerNames" style="font-size: 0.95em; opacity: 0.9; margin-top: 5px; text-transform: none; font-weight: 700;"></p>
        <p id="liturgicalCelebration" style="font-size: 0.8em; font-style: italic; margin-top: 8px; opacity: 0.9; line-height: 1.4;"></p>
        <p id="saintOfTheDay" style="font-size: 0.75em; margin-top: 5px; opacity: 0.8; font-weight: 700;"></p>
        <p style="margin-top: 10px; font-weight: 700; letter-spacing: 1px;">ORA√á√ÉO DI√ÅRIA</p>
    </header>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item active" id="navHome">
            <span class="nav-icon">üè†</span>
            <span>In√≠cio</span>
        </div>
        <div class="nav-item" id="navPce">
            <span class="nav-icon">üéØ</span>
            <span>PCEs</span>
        </div>
        <div class="nav-item" id="navDiary">
            <span class="nav-icon">üìñ</span>
            <span>Di√°rio</span>
        </div>
        <div class="nav-item" id="navCouple">
            <span class="nav-icon">üíë</span>
            <span>Casal</span>
        </div>
    </nav>

    <!-- Success Overlay -->
    <div id="successOverlay" class="success-overlay">
        <div class="success-icon">üôè</div>
        <div class="success-text">Ora√ß√£o conclu√≠da!<br>Que Deus te aben√ßoe!</div>
    </div>

    <!-- Welcome Modal -->
    <div id="welcomeModal" class="modal-overlay">
        <div class="modal-content">
            <h2>Bem-vindo!</h2>
            <p>Para come√ßar sua jornada de ora√ß√£o, como podemos te chamar?</p>
            <input type="text" id="userNameInput" placeholder="Seu nome" style="margin-bottom: 25px;">
            <button id="startAppBtn" class="btn btn-primary">Come√ßar</button>
        </div>
    </div>

    <!-- Common Prayers Modal -->
    <div id="commonPrayersModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 480px;">
            <h2>Ora√ß√µes Comuns</h2>
            <div id="prayerLibraryList" style="max-height: 60vh; overflow-y: auto; margin-top: 20px;">
                <!-- Prayers will be injected here -->
            </div>
            <button id="closeCommonPrayersModal" class="btn btn-secondary" style="margin-top: 25px;">Fechar</button>
        </div>
    </div>

    <!-- Prayer Detail Modal -->
    <div id="prayerDetailModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 480px; text-align: left;">
            <h2 id="prayerDetailTitle" style="text-align: center;">T√≠tulo</h2>
            <div id="prayerDetailText" style="font-size: 1.1em; line-height: 1.8; margin-top: 20px; white-space: pre-wrap;">Texto da ora√ß√£o...</div>
            <button id="closePrayerDetailModal" class="btn btn-secondary" style="margin-top: 25px; width: 100%;">Voltar</button>
        </div>
    </div>

    <!-- PCE Modal -->
    <div id="pceModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 460px;">
            <h2>Pontos Concretos de Esfor√ßo</h2>
            
            <div id="pceStats" class="stats-container">
                <div class="stat-row">
                    <span class="stat-label">Escuta Palavra</span>
                    <div class="stat-bar-bg"><div id="statBar1" class="stat-bar-fill" style="width: 0%"></div></div>
                    <span id="statVal1" class="stat-value">0%</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Ora√ß√£o Conjugal</span>
                    <div class="stat-bar-bg"><div id="statBar2" class="stat-bar-fill" style="width: 0%"></div></div>
                    <span id="statVal2" class="stat-value">0%</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Dever Sentar-se</span>
                    <div class="stat-bar-bg"><div id="statBar3" class="stat-bar-fill" style="width: 0%"></div></div>
                    <span id="statVal3" class="stat-value">0%</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Regra de Vida</span>
                    <div class="stat-bar-bg"><div id="statBar4" class="stat-bar-fill" style="width: 0%"></div></div>
                    <span id="statVal4" class="stat-value">0%</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Ora√ß√£o Pessoal</span>
                    <div class="stat-bar-bg"><div id="statBar5" class="stat-bar-fill" style="width: 0%"></div></div>
                    <span id="statVal5" class="stat-value">0%</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Retiro Anual</span>
                    <div class="stat-bar-bg"><div id="statBar6" class="stat-bar-fill" style="width: 0%"></div></div>
                    <span id="statVal6" class="stat-value">0%</span>
                </div>
            </div>

            <div class="pce-grid">
                <div class="pce-card" id="pce1Btn">
                    <div class="pce-card-icon">üìñ</div>
                    <div class="pce-card-title">Escuta da Palavra</div>
                </div>
                <div class="pce-card" id="pce2Btn">
                    <div class="pce-card-icon">üíë</div>
                    <div class="pce-card-title">Ora√ß√£o Conjugal</div>
                </div>
                <div class="pce-card" id="pce3Btn">
                    <div class="pce-card-icon">ü™ë</div>
                    <div class="pce-card-title">Dever de Sentar-se</div>
                </div>
                <div class="pce-card" id="pce4Btn">
                    <div class="pce-card-icon">üìú</div>
                    <div class="pce-card-title">Regra de Vida</div>
                </div>
                <div class="pce-card" id="pce5Btn">
                    <div class="pce-card-icon">üßò</div>
                    <div class="pce-card-title">Ora√ß√£o Pessoal</div>
                </div>
                <div class="pce-card" id="pce6Btn">
                    <div class="pce-card-icon">‚õ™</div>
                    <div class="pce-card-title">Retiro Anual</div>
                </div>
            </div>
            <button id="pceHistoryBtn" class="btn btn-secondary" style="margin-top: 25px;">Ver Hist√≥rico de PCEs</button>
            <button id="closePceModal" class="btn btn-secondary" style="margin-top: 12px; border: none;">Fechar</button>
        </div>
    </div>

    <!-- PCE History Modal -->
    <div id="pceHistoryModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <h2>Hist√≥rico de PCEs</h2>
            <div id="pceHistoryList" style="max-height: 50vh; overflow-y: auto; border: 1px solid var(--border); border-radius: var(--radius-md); padding: 15px; text-align: left;"></div>
            <button id="closePceHistoryModal" class="btn btn-secondary" style="margin-top: 25px;">Voltar</button>
        </div>
    </div>

    <!-- Escuta da Palavra Modal -->
    <div id="wordModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 450px;">
            <h2>Escuta da Palavra</h2>
            <p>Registre sua leitura b√≠blica de hoje.</p>
            <div class="time-input-container" style="text-align: left;">
                <label class="time-input-label">Passagem Lida</label>
                <input type="text" id="wordPassage" placeholder="Ex: Jo√£o 1, 1-14">
            </div>
            <textarea id="wordKeyWord" placeholder="Uma palavra ou frase que marcou sua leitura..."></textarea>
            <button id="saveWord" class="btn btn-primary">Salvar Registro</button>
            <button id="closeWordModal" class="btn btn-secondary" style="margin-top: 12px;">Voltar</button>
        </div>
    </div>

    <!-- Dever de Sentar-se Modal -->
    <div id="sitDownModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 450px;">
            <h2>Dever de Sentar-se</h2>
            <p>O di√°logo mensal do casal sob o olhar de Deus.</p>
            <div style="margin-bottom: 20px;">
                <button id="sitDownGuideBtn" class="btn btn-secondary" style="padding: 10px; font-size: 0.85em;">üìñ Ver Guia de Di√°logo</button>
            </div>
            <div class="time-input-container" style="text-align: left;">
                <label class="time-input-label">Data do Di√°logo</label>
                <input type="date" id="sitDownDate">
            </div>
            <textarea id="sitDownNotes" placeholder="Notas ou pontos principais do di√°logo..."></textarea>
            <button id="saveSitDown" class="btn btn-primary">Salvar Registro</button>
            <button id="closeSitDownModal" class="btn btn-secondary" style="margin-top: 12px;">Voltar</button>
        </div>
    </div>

    <!-- Sit Down Guide Modal -->
    <div id="sitDownGuideModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 450px; text-align: left;">
            <h2>Guia: Dever de Sentar-se</h2>
            <div style="font-size: 0.95em; line-height: 1.6; margin-top: 20px;">
                <p><strong>1. In√≠cio:</strong> Comecem com uma ora√ß√£o ao Esp√≠rito Santo.</p>
                <p><strong>2. Revis√£o:</strong> Como foi o m√™s? Quais foram as alegrias e dificuldades?</p>
                <p><strong>3. PCEs:</strong> Como estamos progredindo nos nossos Pontos Concretos de Esfor√ßo?</p>
                <p><strong>4. Di√°logo:</strong> H√° algo que precisamos conversar abertamente? (Finan√ßas, filhos, sexualidade, espiritualidade).</p>
                <p><strong>5. Regra de Vida:</strong> Vamos definir ou revisar nossa Regra de Vida para o pr√≥ximo m√™s?</p>
                <p><strong>6. Encerramento:</strong> Rezem juntos o Pai Nosso ou o Magnificat.</p>
            </div>
            <button id="closeSitDownGuideModal" class="btn btn-secondary" style="margin-top: 25px; width: 100%;">Entendido</button>
        </div>
    </div>

    <!-- Regra de Vida Modal -->
    <div id="ruleOfLifeModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 450px;">
            <h2>Regra de Vida</h2>
            <p>Um esfor√ßo pessoal para progredir espiritualmente.</p>
            <textarea id="ruleOfLifeText" placeholder="Qual √© o seu esfor√ßo concreto para este m√™s?"></textarea>
            <button id="saveRuleOfLife" class="btn btn-primary">Salvar Regra</button>
            <button id="closeRuleOfLifeModal" class="btn btn-secondary" style="margin-top: 12px;">Voltar</button>
        </div>
    </div>

    <!-- Ora√ß√£o Pessoal Modal -->
    <div id="meditationModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 450px;">
            <h2>Ora√ß√£o Pessoal</h2>
            <p>Um tempo de sil√™ncio e medita√ß√£o di√°ria.</p>
            <div class="time-input-container" style="text-align: left;">
                <label class="time-input-label">Dura√ß√£o (minutos)</label>
                <input type="number" id="meditationDuration" placeholder="Ex: 15">
            </div>
            <textarea id="meditationNotes" placeholder="O que Deus falou ao seu cora√ß√£o hoje?"></textarea>
            <button id="saveMeditation" class="btn btn-primary">Salvar Registro</button>
            <button id="closeMeditationModal" class="btn btn-secondary" style="margin-top: 12px;">Voltar</button>
        </div>
    </div>

    <!-- Retiro Anual Modal -->
    <div id="retreatModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 450px;">
            <h2>Retiro Anual</h2>
            <p>Um tempo forte de renova√ß√£o espiritual.</p>
            <div class="time-input-container" style="text-align: left;">
                <label class="time-input-label">Data do Retiro</label>
                <input type="date" id="retreatDate">
            </div>
            <textarea id="retreatNotes" placeholder="Principais frutos do retiro..."></textarea>
            <button id="saveRetreat" class="btn btn-primary">Salvar Registro</button>
            <button id="closeRetreatModal" class="btn btn-secondary" style="margin-top: 12px;">Voltar</button>
        </div>
    </div>

    <!-- Couple Modal -->
    <div id="coupleModal" class="modal-overlay">
        <div class="modal-content">
            <h2 id="coupleModalTitle">Conectar Casal</h2>
            <div id="notConnectedView">
                <p>Seu nome: <strong id="displayMyName">...</strong></p>
                <p>Conecte-se com seu c√¥njuge para acompanharem a ora√ß√£o um do outro.</p>
                
                <div style="margin: 25px 0;">
                    <button id="generateInviteBtn" class="btn btn-primary">Gerar C√≥digo de Convite</button>
                </div>
                
                <div id="inviteLinkArea" style="display: none; margin-top: 25px;">
                    <p style="font-size: 0.85em; color: var(--accent); font-weight: 700; letter-spacing: 1px;">SEU C√ìDIGO:</p>
                    <input type="text" id="inviteLinkInput" readonly style="text-align: center; font-size: 1.6em; letter-spacing: 6px; margin-bottom: 15px; border-color: var(--accent);">
                    <div style="display: flex; gap: 12px;">
                        <button id="copyInviteBtn" class="btn btn-secondary" style="padding: 12px; font-size: 0.8em;">Copiar</button>
                        <button id="shareWhatsappBtn" class="btn btn-primary" style="padding: 12px; font-size: 0.8em; background: #25D366; border: none;">WhatsApp</button>
                    </div>
                </div>

                <div style="margin-top: 35px; border-top: 1px solid var(--border); padding-top: 25px;">
                    <p style="font-size: 0.95em;">J√° tem um c√≥digo?</p>
                    <input type="text" id="joinCodeInput" placeholder="Digite o c√≥digo aqui" style="text-align: center; text-transform: uppercase; margin-bottom: 15px;">
                    <button id="joinCoupleBtn" class="btn btn-secondary">Conectar</button>
                </div>
            </div>
            <div id="connectedView" style="display: none;">
                <p>Conectado com: <strong id="partnerName">...</strong></p>
                
                <div id="partnerStatusArea" style="margin: 25px 0; padding: 20px; border-radius: var(--radius-md); background: var(--ai-bg); border: 1px solid var(--border);">
                    <p id="partnerStatusText" style="font-weight: 700;">Carregando status...</p>
                    <button id="nudgeBtn" class="btn btn-secondary" style="margin-top: 15px; font-size: 0.85em; padding: 10px;">üîî Enviar Toque de Ora√ß√£o</button>
                </div>

                <div class="card" style="padding: 20px; text-align: left;">
                    <h3 style="font-size: 1em; color: var(--accent); margin-top: 0; border-bottom: 1px solid var(--border); padding-bottom: 10px; margin-bottom: 15px;">Mural de Inten√ß√µes</h3>
                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <input type="text" id="intentionInput" placeholder="Nova inten√ß√£o..." style="flex: 1; padding: 10px; font-size: 0.95em;">
                        <button id="addIntentionBtn" class="btn btn-primary" style="width: auto; padding: 0 18px; font-size: 1em;">+</button>
                    </div>
                    <div id="intentionsList" class="intentions-list"></div>
                </div>

                <div class="time-input-container" style="text-align: left;">
                    <label class="time-input-label">PCE 2 - Ora√ß√£o Conjugal</label>
                    <div style="display: flex; gap: 12px;">
                        <input type="time" id="conjugalTimeInput" style="flex: 1;">
                        <button id="saveConjugalTime" class="btn btn-primary" style="width: auto; padding: 0 18px; font-size: 0.9em;">Salvar</button>
                    </div>
                </div>

                <div id="aiAdviceArea" class="ai-advice-container" style="display: none;">
                    <div class="ai-advice-header">‚ú® Conselho Espiritual (IA)</div>
                    <div id="aiAdviceText" class="ai-advice-text">Carregando conselho...</div>
                </div>

                <button id="disconnectBtn" class="btn btn-secondary" style="font-size: 0.85em; padding: 12px; margin-top: 25px; color: #ff4d4d; border-color: #ff4d4d;">Desconectar</button>
            </div>
            <button id="closeCoupleModal" class="btn btn-secondary" style="margin-top: 25px; border: none;">Fechar</button>
        </div>
    </div>

    <!-- Diary Modal -->
    <div id="diaryModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <h2>Meu Di√°rio Espiritual</h2>
            <input type="text" id="diarySearch" placeholder="Buscar por data ou palavra..." style="margin-bottom: 25px;">
            <div id="diaryList" style="max-height: 50vh; overflow-y: auto; border: 1px solid var(--border); border-radius: var(--radius-md); padding: 15px;"></div>
            <button id="closeDiaryModal" class="btn btn-secondary" style="margin-top: 25px;">Fechar</button>
        </div>
    </div>

    <!-- Diary Detail Modal -->
    <div id="diaryDetailModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 460px; text-align: left;">
            <h2 id="detailDate" style="text-align: center;">Data</h2>
            <div id="detailContent"></div>
            <div style="display: flex; gap: 12px; margin-top: 25px;">
                <button id="shareReflectionBtn" class="btn btn-primary" style="flex: 1; font-size: 0.9em;">Compartilhar</button>
                <button id="closeDiaryDetailModal" class="btn btn-secondary" style="flex: 1; font-size: 0.9em;">Voltar</button>
            </div>
        </div>
    </div>

    <!-- Main View -->
    <div id="mainView" class="main-container">
        <div class="card">
            <div id="dayCounter" class="day-counter">
                <span id="monthlyCount">üî• 0 dias este m√™s</span>
                <span id="streakCount">‚ö° 0 dias seguidos</span>
            </div>
            <div class="calendar-container">
                <div id="calendarMonth" class="calendar-header"></div>
                <div class="calendar-grid" id="calendarGrid">
                    <div class="calendar-day-name">Dom</div>
                    <div class="calendar-day-name">Seg</div>
                    <div class="calendar-day-name">Ter</div>
                    <div class="calendar-day-name">Qua</div>
                    <div class="calendar-day-name">Qui</div>
                    <div class="calendar-day-name">Sex</div>
                    <div class="calendar-day-name">S√°b</div>
                </div>
            </div>

            <div id="homePceSummary" class="home-pce-summary">
                <div class="home-pce-item">
                    <span class="home-pce-label">Minha Regra de Vida</span>
                    <div id="homeRuleValue" class="home-pce-value">Nenhuma regra definida para este m√™s.</div>
                </div>
                <div class="home-pce-item">
                    <span class="home-pce-label">√öltima Escuta da Palavra</span>
                    <div id="homeWordValue" class="home-pce-value">Nenhum registro recente.</div>
                </div>
            </div>
        </div>

        <div class="method-selector">
            <button class="method-btn" data-method="simples">Liturgia Simples</button>
            <button class="method-btn" data-method="lectio">Lectio Divina</button>
            <button class="method-btn" data-method="rapido">M√©todo R√°pido</button>
        </div>

        <div id="sliderWrapper" class="slider-wrapper">
            <div id="sliderContainer" class="slider-container">
                <div id="cardsWrapper"></div>
            </div>
            <div class="slider-controls">
                <button id="prevBtn" class="nav-arrow">‚Üê</button>
                <div id="progressIndicator" class="progress-indicator">1 / 1</div>
                <button id="nextBtn" class="nav-arrow">‚Üí</button>
            </div>
        </div>
        
        <div class="actions" id="prayerActions">
            <button id="markAsDone" class="btn btn-primary">Marcar como Conclu√≠do</button>
            <button id="shareBtn" class="btn btn-secondary">Compartilhar Evangelho</button>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="audioRain" loop src="https://www.soundjay.com/nature/rain-01.mp3"></audio>
    <audio id="audioChant" loop src="https://www.soundjay.com/misc/sounds/bell-ringing-01.mp3"></audio>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="/assets/prayer/script.js"></script>
</body>
</html>